/*
 * OverlappingMarkerSpiderfier: 
 * https://github.com/jawj/OverlappingMarkerSpiderfier
 *
 * Copyright (c) 2011 George MacKerron
 * Released under the MIT licence: http://opensource.org/licenses/mit-license
 */
(function(){var l=null;
(function(){function n(a,b){return function(){return a.apply(b,arguments)}}var k,i,h,m,j,o,p=Array.prototype.slice;i=google.maps;o=Math.PI*2;k=function(){function a(b){var c,f,d;this.map=b;this.i=new this.constructor.b(this.map);this.d=[];this.f={};d=["click","zoom_changed","maptypeid_changed"];c=0;for(f=d.length;c<f;c++)b=d[c],i.event.addListener(this.map,b,n(function(){return this.m()},this))}a.prototype.nearbyDistance=20;a.prototype.circleFootSeparation=23;a.prototype.circleStartAngle=o/12;a.prototype.spiralFootSeparation=
26;a.prototype.spiralLengthStart=11;a.prototype.spiralLengthFactor=4;a.prototype.circleSpiralSwitchover=9;a.prototype.usualZIndex=10;a.prototype.spiderfiedZIndex=1E4;a.prototype.usualLegZIndex=9;a.prototype.highlightedLegZIndex=9999;a.prototype.legWeight=1.5;a.prototype.legColors={usual:{},highlighted:{}};a.prototype.addListener=function(b,c){var f,d;((d=(f=this.f)[b])!=l?d:f[b]=[]).push(c);return this};a.prototype.trigger=function(){var e;var b,c,f,d,g;c=arguments[0];b=2<=arguments.length?p.call(arguments,
1):[];e=(f=this.f[c])!=l?f:[],c=e;d=0;for(g=c.length;d<g;d++)f=c[d],f.apply(l,b);return this};a.prototype.addMarker=function(b){i.event.addListener(b,"click",n(function(){return this.w(b)},this));b.setZIndex(this.usualZIndex);this.d.push(b);return this};a.prototype.t=function(b,c){var f,d,g,e,a,i,j,h;e=[];a=c*c;g=this.g(b.position);h=this.d;i=0;for(j=h.length;i<j;i++)f=h[i],d=this.g(f.position),this.j(d,g)<a&&e.push({r:f,h:d});return e};a.prototype.n=function(b,c){var f,d,g,e,a;e=this.circleFootSeparation*
(2+b)/o;d=o/b;a=[];for(g=0;0<=b?g<b:g>b;0<=b?g++:g--)f=this.circleStartAngle+g*d,a.push(new i.Point(c.x+e*Math.cos(f),c.y+e*Math.sin(f)));return a};a.prototype.o=function(b,c){var f,d,a,e,h;a=this.spiralLengthStart;f=0;h=[];for(d=0;0<=b?d<b:d>b;0<=b?d++:d--)f+=this.spiralFootSeparation/a+d*5.0E-4,e=new i.Point(c.x+a*Math.cos(f),c.y+a*Math.sin(f)),a+=o*this.spiralLengthFactor/f,h.push(e);return h};a.prototype.w=function(b){var c;c=b.a!=l;this.m();return c?this.trigger("click",b):(c=this.t(b,this.nearbyDistance),
c.length===1?this.trigger("click",b):this.z(c))};a.prototype.q=function(b){return{e:n(function(){return b.a.c.setOptions({strokeColor:this.legColors.highlighted[this.map.mapTypeId],zIndex:this.highlightedLegZIndex})},this),l:n(function(){return b.a.c.setOptions({strokeColor:this.legColors.usual[this.map.mapTypeId],zIndex:this.usualLegZIndex})},this)}};a.prototype.z=function(b){var c,a,d,g,e,h,j,k,m;this.k=!0;d=b.length;c=this.u(function(){var c,a,d;d=[];c=0;for(a=b.length;c<a;c++)h=b[c],d.push(h.h);
return d}());d=d>=this.circleSpiralSwitchover?this.o(d,c).reverse():this.n(d,c);j=[];k=0;for(m=d.length;k<m;k++){a=d[k];c=this.v(a);e=this.s(b,n(function(b){return this.j(b.h,a)},this));e=e.r;g=new i.Polyline({map:this.map,path:[e.position,c],strokeColor:this.legColors.usual[this.map.mapTypeId],strokeWeight:this.legWeight,zIndex:this.usualLegZIndex});e.a={A:e.position,c:g};if(this.legColors.highlighted[this.map.mapTypeId]!==this.legColors.usual[this.map.mapTypeId])g=this.q(e),i.event.addListener(e,
"mouseover",g.e),i.event.addListener(e,"mouseout",g.l),e.a.p=g;e.setZIndex(this.spiderfiedZIndex+a.y);e.setPosition(c);j.push(e)}return this.trigger("spiderfy",j)};a.prototype.m=function(){var b,c,a,d,g,e;if(this.k!=l){delete this.k;a=[];e=this.d;d=0;for(g=e.length;d<g;d++)if(c=e[d],c.a!=l)c.a.c.setMap(l),c.setZIndex(this.usualZIndex),c.setPosition(c.a.A),b=c.a.p,b!=l&&(i.event.clearListeners(c,"mouseover",b.e),i.event.clearListeners(c,"mouseout",b.l)),delete c.a,a.push(c);return this.trigger("unspiderfy",
a)}};a.prototype.j=function(b,c){var a,d;a=b.x-c.x;d=b.y-c.y;return a*a+d*d};a.prototype.u=function(b){var a,f,d,g,e;g=f=d=0;for(e=b.length;g<e;g++)a=b[g],f+=a.x,d+=a.y;b=b.length;return new i.Point(f/b,d/b)};a.prototype.g=function(b){return this.i.getProjection().fromLatLngToDivPixel(b)};a.prototype.v=function(b){return this.i.getProjection().fromDivPixelToLatLng(b)};a.prototype.s=function(b,a){var f,d,g,e,h;g=0;for(h=b.length;g<h;g++)if(e=b[g],e=a(e),!(typeof f!=="undefined"&&f!==l)||e<d)d=e,f=
g;return b.splice(f,1)[0]};return a}();k.b=function(a){return this.setMap(a)};k.b.prototype=new i.OverlayView;k.b.prototype.draw=function(){};j=i.MapTypeId;h=k.prototype.legColors;m=h.usual;h=h.highlighted;m[j.HYBRID]=m[j.SATELLITE]="#fff";h[j.HYBRID]=h[j.SATELLITE]="#f00";m[j.TERRAIN]=m[j.ROADMAP]="#444";h[j.TERRAIN]=h[j.ROADMAP]="#f00";this.OverlappingMarkerSpiderfier=k}).call(this);}).call(this);
