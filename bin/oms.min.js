(function(){/*
 OverlappingMarkerSpiderfier
 https://github.com/jawj/OverlappingMarkerSpiderfier
 Copyright (c) 2011 George MacKerron
 Released under the MIT licence: http://opensource.org/licenses/mit-license
*/
var l=null;
(function(){function o(i,h){return function(){return i.apply(h,arguments)}}var q=Array.prototype.slice;this.OverlappingMarkerSpiderfier=function(){function i(a){var c,d,e;this.map=a;this.l=new this.constructor.d(this.map);this.i();this.b={};e=["click","zoom_changed","maptypeid_changed"];c=0;for(d=e.length;c<d;c++)a=e[c],h.event.addListener(this.map,a,o(function(){return this.unspiderfy()},this))}var h,m,k,f,b,p;b=i.prototype;b.VERSION="0.1.5";h=google.maps;f=h.MapTypeId;p=Math.PI*2;b.nearbyDistance=20;
b.circleSpiralSwitchover=9;b.circleFootSeparation=23;b.circleStartAngle=p/12;b.spiralFootSeparation=26;b.spiralLengthStart=11;b.spiralLengthFactor=4;b.spiderfiedZIndex=1E3;b.usualLegZIndex=10;b.highlightedLegZIndex=20;b.legWeight=1.5;b.legColors={usual:{},highlighted:{}};k=b.legColors.usual;m=b.legColors.highlighted;k[f.HYBRID]=k[f.SATELLITE]="#fff";m[f.HYBRID]=m[f.SATELLITE]="#f00";k[f.TERRAIN]=k[f.ROADMAP]="#444";m[f.TERRAIN]=m[f.ROADMAP]="#f00";b.i=function(){this.c=[];this.f=[]};b.addMarker=function(a){this.f.push(h.event.addListener(a,
"click",o(function(){return this.A(a)},this)));this.c.push(a);return this};b.removeMarker=function(a){var c;a.a!=l&&this.unspiderfy();a=this.g(this.c,a);if(!(a<0))return c=this.f.splice(a,1)[0],h.event.removeListener(c),this.c.splice(a,1),this};b.clearMarkers=function(){var a,c,d,e;this.unspiderfy();e=this.f;c=0;for(d=e.length;c<d;c++)a=e[c],h.event.removeListener(a);this.i();return this};b.addListener=function(a,c){var d,e;((e=(d=this.b)[a])!=l?e:d[a]=[]).push(c);return this};b.removeListener=function(a,
c){var d;d=this.g(this.b[a],c);d<0||this.b[a].splice(d,1);return this};b.clearListeners=function(a){this.b[a]=[];return this};b.trigger=function(){var g;var a,c,d,e,n,b;c=arguments[0];a=2<=arguments.length?q.call(arguments,1):[];g=(d=this.b[c])!=l?d:[],c=g;b=[];e=0;for(n=c.length;e<n;e++)d=c[e],b.push(d.apply(l,a));return b};b.v=function(a,c){var d,e,b,g,j,h,f,i;g=[];j=c*c;b=this.j(a.position);i=this.c;h=0;for(f=i.length;h<f;h++)d=i[h],d.visible&&(e=this.j(d.position),this.m(e,b)<j&&g.push({t:d,k:e}));
return g};b.p=function(a,c){var d,e,b,g,j;g=this.circleFootSeparation*(2+a)/p;e=p/a;j=[];for(b=0;0<=a?b<a:b>a;0<=a?b+=1:b-=1)d=this.circleStartAngle+b*e,j.push(new h.Point(c.x+g*Math.cos(d),c.y+g*Math.sin(d)));return j};b.q=function(a,c){var d,e,b,g,j;b=this.spiralLengthStart;d=0;j=[];for(e=0;0<=a?e<a:e>a;0<=a?e+=1:e-=1)d+=this.spiralFootSeparation/b+e*5.0E-4,g=new h.Point(c.x+b*Math.cos(d),c.y+b*Math.sin(d)),b+=p*this.spiralLengthFactor/d,j.push(g);return j};b.A=function(a){var c;c=a.a!=l;this.unspiderfy();
return c?this.trigger("click",a):(c=this.v(a,this.nearbyDistance),c.length===1?this.trigger("click",a):this.B(c))};b.s=function(a){return{h:o(function(){return a.a.e.setOptions({strokeColor:this.legColors.highlighted[this.map.mapTypeId],zIndex:this.highlightedLegZIndex})},this),o:o(function(){return a.a.e.setOptions({strokeColor:this.legColors.usual[this.map.mapTypeId],zIndex:this.usualLegZIndex})},this)}};b.B=function(a){var c,d,b,n,g,j,f,i,m,k;this.n=!0;k=a.length;c=this.w(function(){var c,b,d;
d=[];c=0;for(b=a.length;c<b;c++)i=a[c],d.push(i.k);return d}());n=k>=this.circleSpiralSwitchover?this.q(k,c).reverse():this.p(k,c);return this.trigger("spiderfy",function(){var c,i,k;k=[];c=0;for(i=n.length;c<i;c++){b=n[c];d=this.z(b);m=this.u(a,o(function(a){return this.m(a.k,b)},this));f=m.t;g=new h.Polyline({map:this.map,path:[f.position,d],strokeColor:this.legColors.usual[this.map.mapTypeId],strokeWeight:this.legWeight,zIndex:this.usualLegZIndex});f.a={C:f.position,e:g};if(this.legColors.highlighted[this.map.mapTypeId]!==
this.legColors.usual[this.map.mapTypeId])j=this.s(f),h.event.addListener(f,"mouseover",j.h),h.event.addListener(f,"mouseout",j.o),f.a.r=j;f.setPosition(d);f.setZIndex(Math.round(this.spiderfiedZIndex+b.y));k.push(f)}return k}.call(this))};b.unspiderfy=function(){var a,c,b,e,f,g;if(this.n!=l){delete this.n;b=[];g=this.c;e=0;for(f=g.length;e<f;e++)if(c=g[e],c.a!=l)c.a.e.setMap(l),c.setPosition(c.a.C),c.setZIndex(l),a=c.a.r,a!=l&&(h.event.clearListeners(c,"mouseover",a.h),h.event.clearListeners(c,"mouseout",
a.o)),delete c.a,b.push(c);this.trigger("unspiderfy",b);return this}};b.m=function(a,c){var b,e;b=a.x-c.x;e=a.y-c.y;return b*b+e*e};b.w=function(a){var c,b,e,f,g;f=b=e=0;for(g=a.length;f<g;f++)c=a[f],b+=c.x,e+=c.y;a=a.length;return new h.Point(b/a,e/a)};b.j=function(a){return this.l.getProjection().fromLatLngToDivPixel(a)};b.z=function(a){return this.l.getProjection().fromDivPixelToLatLng(a)};b.u=function(a,b){var d,e,f,g,h;f=0;for(h=a.length;f<h;f++)if(g=a[f],g=b(g),!(typeof d!="undefined"&&d!==
l)||g<e)e=g,d=f;return a.splice(d,1)[0]};b.g=function(a,b){var d,e,f;if(a.indexOf!=l)return a.indexOf(b);d=0;for(f=a.length;d<f;d++)if(e=a[d],e===b)return d;return-1};i.d=function(a){return this.setMap(a)};i.d.prototype=new h.OverlayView;i.d.prototype.draw=function(){};return i}()}).call(this);}).call(this);
/* Sat 6 Aug 2011 12:23:12 BST */
