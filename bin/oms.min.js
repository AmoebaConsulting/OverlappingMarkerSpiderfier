(function(){/*
 OverlappingMarkerSpiderfier
 https://github.com/jawj/OverlappingMarkerSpiderfier
 Copyright (c) 2011 George MacKerron
 Released under the MIT licence: http://opensource.org/licenses/mit-license
*/
var l=null;
(function(){function o(i,g){return function(){return i.apply(g,arguments)}}var q=Array.prototype.slice;this.OverlappingMarkerSpiderfier=function(){function i(a){var c,f,d;this.map=a;this.k=new this.constructor.c(this.map);this.g();this.h={};d=["click","zoom_changed","maptypeid_changed"];c=0;for(f=d.length;c<f;c++)a=d[c],g.event.addListener(this.map,a,o(function(){return this.unspiderfy()},this))}var g,m,k,e,b,p;b=i.prototype;b.VERSION="0.1.4";g=google.maps;e=g.MapTypeId;p=Math.PI*2;b.nearbyDistance=20;
b.circleSpiralSwitchover=9;b.circleFootSeparation=23;b.circleStartAngle=p/12;b.spiralFootSeparation=26;b.spiralLengthStart=11;b.spiralLengthFactor=4;b.spiderfiedZIndex=1E3;b.usualLegZIndex=10;b.highlightedLegZIndex=20;b.legWeight=1.5;b.legColors={usual:{},highlighted:{}};k=b.legColors.usual;m=b.legColors.highlighted;k[e.HYBRID]=k[e.SATELLITE]="#fff";m[e.HYBRID]=m[e.SATELLITE]="#f00";k[e.TERRAIN]=k[e.ROADMAP]="#444";m[e.TERRAIN]=m[e.ROADMAP]="#f00";b.g=function(){this.b=[];this.e=[]};b.addMarker=function(a){this.e.push(g.event.addListener(a,
"click",o(function(){return this.A(a)},this)));this.b.push(a);return this};b.removeMarker=function(a){var c;a.a!=l&&this.unspiderfy();a=this.o(this.b,a);if(!(a<0))return c=this.e.splice(a,1)[0],g.event.removeListener(c),this.b.splice(a,1),this};b.clearMarkers=function(){var a,c,f,d;this.unspiderfy();d=this.e;c=0;for(f=d.length;c<f;c++)a=d[c],g.event.removeListener(a);this.g();return this};b.addListener=function(a,c){var f,d;((d=(f=this.h)[a])!=l?d:f[a]=[]).push(c);return this};b.trigger=function(){var h;
var a,c,f,d,n,b;c=arguments[0];a=2<=arguments.length?q.call(arguments,1):[];h=(f=this.h[c])!=l?f:[],c=h;b=[];d=0;for(n=c.length;d<n;d++)f=c[d],b.push(f.apply(l,a));return b};b.v=function(a,c){var f,d,b,h,j,g,e,i;h=[];j=c*c;b=this.i(a.position);i=this.b;g=0;for(e=i.length;g<e;g++)f=i[g],d=this.i(f.position),this.l(d,b)<j&&h.push({t:f,j:d});return h};b.p=function(a,c){var f,d,b,h,j;h=this.circleFootSeparation*(2+a)/p;d=p/a;j=[];for(b=0;0<=a?b<a:b>a;0<=a?b+=1:b-=1)f=this.circleStartAngle+b*d,j.push(new g.Point(c.x+
h*Math.cos(f),c.y+h*Math.sin(f)));return j};b.q=function(a,c){var f,d,b,h,j;b=this.spiralLengthStart;f=0;j=[];for(d=0;0<=a?d<a:d>a;0<=a?d+=1:d-=1)f+=this.spiralFootSeparation/b+d*5.0E-4,h=new g.Point(c.x+b*Math.cos(f),c.y+b*Math.sin(f)),b+=p*this.spiralLengthFactor/f,j.push(h);return j};b.A=function(a){var c;c=a.a!=l;this.unspiderfy();return c?this.trigger("click",a):(c=this.v(a,this.nearbyDistance),c.length===1?this.trigger("click",a):this.B(c))};b.s=function(a){return{f:o(function(){return a.a.d.setOptions({strokeColor:this.legColors.highlighted[this.map.mapTypeId],
zIndex:this.highlightedLegZIndex})},this),n:o(function(){return a.a.d.setOptions({strokeColor:this.legColors.usual[this.map.mapTypeId],zIndex:this.usualLegZIndex})},this)}};b.B=function(a){var c,b,d,n,h,j,e,i,m,k;this.m=!0;k=a.length;c=this.w(function(){var c,b,d;d=[];c=0;for(b=a.length;c<b;c++)i=a[c],d.push(i.j);return d}());n=k>=this.circleSpiralSwitchover?this.q(k,c).reverse():this.p(k,c);return this.trigger("spiderfy",function(){var c,i,k;k=[];c=0;for(i=n.length;c<i;c++){d=n[c];b=this.z(d);m=
this.u(a,o(function(a){return this.l(a.j,d)},this));e=m.t;h=new g.Polyline({map:this.map,path:[e.position,b],strokeColor:this.legColors.usual[this.map.mapTypeId],strokeWeight:this.legWeight,zIndex:this.usualLegZIndex});e.a={C:e.position,d:h};if(this.legColors.highlighted[this.map.mapTypeId]!==this.legColors.usual[this.map.mapTypeId])j=this.s(e),g.event.addListener(e,"mouseover",j.f),g.event.addListener(e,"mouseout",j.n),e.a.r=j;e.setPosition(b);e.setZIndex(Math.round(this.spiderfiedZIndex+d.y));k.push(e)}return k}.call(this))};
b.unspiderfy=function(){var a,c,b,d,e,h;if(this.m!=l){delete this.m;b=[];h=this.b;d=0;for(e=h.length;d<e;d++)if(c=h[d],c.a!=l)c.a.d.setMap(l),c.setPosition(c.a.C),c.setZIndex(l),a=c.a.r,a!=l&&(g.event.clearListeners(c,"mouseover",a.f),g.event.clearListeners(c,"mouseout",a.n)),delete c.a,b.push(c);this.trigger("unspiderfy",b);return this}};b.l=function(a,c){var b,d;b=a.x-c.x;d=a.y-c.y;return b*b+d*d};b.w=function(a){var c,b,d,e,h;e=b=d=0;for(h=a.length;e<h;e++)c=a[e],b+=c.x,d+=c.y;a=a.length;return new g.Point(b/
a,d/a)};b.i=function(a){return this.k.getProjection().fromLatLngToDivPixel(a)};b.z=function(a){return this.k.getProjection().fromDivPixelToLatLng(a)};b.u=function(a,b){var f,d,e,h,g;e=0;for(g=a.length;e<g;e++)if(h=a[e],h=b(h),!(typeof f!="undefined"&&f!==l)||h<d)d=h,f=e;return a.splice(f,1)[0]};b.o=function(a,b){var e,d,g;if(a.indexOf!=l)return a.indexOf(b);e=0;for(g=a.length;e<g;e++)if(d=a[e],d===b)return e;return-1};i.c=function(a){return this.setMap(a)};i.c.prototype=new g.OverlayView;i.c.prototype.draw=
function(){};return i}()}).call(this);}).call(this);
/* Sat 6 Aug 2011 11:30:00 BST */
