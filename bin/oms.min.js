(function(){/*
 OverlappingMarkerSpiderfier
 https://github.com/jawj/OverlappingMarkerSpiderfier
 Copyright (c) 2011 - 2012 George MacKerron
 Released under the MIT licence: http://opensource.org/licenses/mit-license
 Note: The Google Maps API v3 must be included *before* this code
*/
var h=null;
(function(){var s,t={}.hasOwnProperty,u=[].slice;if(((s=this.google)!=h?s.maps:void 0)!=h)this.OverlappingMarkerSpiderfier=function(){function n(c,d){var a,e,g,f,b=this;this.map=c;d==h&&(d={});for(a in d)t.call(d,a)&&(e=d[a],this[a]=e);this.m=new this.constructor.c(this.map);this.i();this.b={};f=["click","zoom_changed","maptypeid_changed"];e=0;for(g=f.length;e<g;e++)a=f[e],k.addListener(this.map,a,function(){return b.unspiderfy()})}var k,o,m,q,i,b,r;b=n.prototype;b.VERSION="0.2.5";o=google.maps;k=
o.event;i=o.MapTypeId;r=2*Math.PI;b.keepSpiderfied=!1;b.markersWontHide=!1;b.markersWontMove=!1;b.nearbyDistance=20;b.circleSpiralSwitchover=9;b.circleFootSeparation=23;b.circleStartAngle=r/12;b.spiralFootSeparation=26;b.spiralLengthStart=11;b.spiralLengthFactor=4;b.spiderfiedZIndex=1E3;b.usualLegZIndex=10;b.highlightedLegZIndex=20;b.legWeight=1.5;b.legColors={usual:{},highlighted:{}};q=b.legColors.usual;m=b.legColors.highlighted;q[i.HYBRID]=q[i.SATELLITE]="#fff";m[i.HYBRID]=m[i.SATELLITE]="#f00";
q[i.TERRAIN]=q[i.ROADMAP]="#444";m[i.TERRAIN]=m[i.ROADMAP]="#f00";b.i=function(){this.a=[];this.g=[]};b.addMarker=function(c,d){var a,e=this;d==h&&(d=!1);if(!(d||-1===this.d(this.a,c)))return this;a=[k.addListener(c,"click",function(){return e.B(c)})];this.markersWontHide||a.push(k.addListener(c,"visible_changed",function(){return e.k(c,!1)}));this.markersWontMove||a.push(k.addListener(c,"position_changed",function(){return e.k(c,!0)}));this.g.push(a);this.a.push(c);return this};b.k=function(c,d){if(c._omsData!=
h&&(d||!c.getVisible())&&!(this.p!=h||this.q!=h))return this.F(d?c:h)};b.getMarkers=function(){return this.a.slice(0)};b.removeMarker=function(c){var d,a,e,g;c._omsData!=h&&this.unspiderfy();c=this.d(this.a,c);if(0>c)return this;a=this.g.splice(c,1)[0];e=0;for(g=a.length;e<g;e++)d=a[e],k.removeListener(d);this.a.splice(c,1);return this};b.clearMarkers=function(){var c,d,a,e,g,f,b;this.unspiderfy();b=this.g;a=0;for(g=b.length;a<g;a++){d=b[a];e=0;for(f=d.length;e<f;e++)c=d[e],k.removeListener(c)}this.i();
return this};b.addListener=function(c,d){var a,e;((e=(a=this.b)[c])!=h?e:a[c]=[]).push(d);return this};b.removeListener=function(c,d){var a;a=this.d(this.b[c],d);0>a||this.b[c].splice(a,1);return this};b.clearListeners=function(c){this.b[c]=[];return this};b.trigger=function(){var c,d,a,e,g,b;d=arguments[0];c=2<=arguments.length?u.call(arguments,1):[];d=(a=this.b[d])!=h?a:[];b=[];e=0;for(g=d.length;e<g;e++)a=d[e],b.push(a.apply(h,c));return b};b.r=function(c,d){var a,e,b,f,j;b=this.circleFootSeparation*
(2+c)/r;e=r/c;j=[];for(a=f=0;0<=c?f<c:f>c;a=0<=c?++f:--f)a=this.circleStartAngle+a*e,j.push(new o.Point(d.x+b*Math.cos(a),d.y+b*Math.sin(a)));return j};b.s=function(c,d){var a,e,b,f,j;b=this.spiralLengthStart;a=0;j=[];for(e=f=0;0<=c?f<c:f>c;e=0<=c?++f:--f)a+=this.spiralFootSeparation/b+5.0E-4*e,e=new o.Point(d.x+b*Math.cos(a),d.y+b*Math.sin(a)),b+=r*this.spiralLengthFactor/a,j.push(e);return j};b.B=function(c){var d,a,e,b,f,j,p,l,k;d=c._omsData!=h;(!d||!this.keepSpiderfied)&&this.unspiderfy();if(d)return this.trigger("click",
c);b=[];f=[];j=this.nearbyDistance*this.nearbyDistance;e=this.j(c.position);k=this.a;p=0;for(l=k.length;p<l;p++)d=k[p],d.getVisible()&&d.map!=h&&(a=this.j(d.position),this.n(a,e)<j?b.push({v:d,l:a}):f.push(d));return 1===b.length?this.trigger("click",c):this.C(b,f)};b.u=function(c){var d=this;return{e:function(){return c._omsData.f.setOptions({strokeColor:d.legColors.highlighted[d.map.mapTypeId],zIndex:d.highlightedLegZIndex})},h:function(){return c._omsData.f.setOptions({strokeColor:d.legColors.usual[d.map.mapTypeId],
zIndex:d.usualLegZIndex})}}};b.C=function(c,d){var a,b,g,f,j,p,l,i,n,m;this.p=!0;m=c.length;a=this.z(function(){var a,d,b;b=[];a=0;for(d=c.length;a<d;a++)i=c[a],b.push(i.l);return b}());f=m>=this.circleSpiralSwitchover?this.s(m,a).reverse():this.r(m,a);a=function(){var a,d,i,m=this;i=[];a=0;for(d=f.length;a<d;a++)g=f[a],b=this.A(g),n=this.w(c,function(a){return m.n(a.l,g)}),l=n.v,p=new o.Polyline({map:this.map,path:[l.position,b],strokeColor:this.legColors.usual[this.map.mapTypeId],strokeWeight:this.legWeight,
zIndex:this.usualLegZIndex}),l._omsData={D:l.position,f:p},this.legColors.highlighted[this.map.mapTypeId]!==this.legColors.usual[this.map.mapTypeId]&&(j=this.u(l),l._omsData.t={e:k.addListener(l,"mouseover",j.e),h:k.addListener(l,"mouseout",j.h)}),l.setPosition(b),l.setZIndex(Math.round(this.spiderfiedZIndex+g.y)),i.push(l);return i}.call(this);delete this.p;this.o=!0;return this.trigger("spiderfy",a,d)};b.unspiderfy=function(c){var d,a,b,g,f,j,i;c==h&&(c=h);if(this.o==h)return this;this.q=!0;g=[];
b=[];i=this.a;f=0;for(j=i.length;f<j;f++)a=i[f],a._omsData!=h?(a._omsData.f.setMap(h),a!==c&&a.setPosition(a._omsData.D),a.setZIndex(h),d=a._omsData.t,d!=h&&(k.removeListener(d.e),k.removeListener(d.h)),delete a._omsData,g.push(a)):b.push(a);delete this.q;delete this.o;this.trigger("unspiderfy",g,b);return this};b.n=function(c,b){var a,e;a=c.x-b.x;e=c.y-b.y;return a*a+e*e};b.z=function(c){var b,a,e,g,f;g=a=e=0;for(f=c.length;g<f;g++)b=c[g],a+=b.x,e+=b.y;c=c.length;return new o.Point(a/c,e/c)};b.j=
function(c){return this.m.getProjection().fromLatLngToDivPixel(c)};b.A=function(c){return this.m.getProjection().fromDivPixelToLatLng(c)};b.w=function(c,b){var a,e,g,f,j,i;g=j=0;for(i=c.length;j<i;g=++j)if(f=c[g],f=b(f),!("undefined"!==typeof a&&a!==h)||f<e)e=f,a=g;return c.splice(a,1)[0]};b.d=function(c,b){var a,e,g,f;if(c.indexOf!=h)return c.indexOf(b);a=g=0;for(f=c.length;g<f;a=++g)if(e=c[a],e===b)return a;return-1};n.c=function(b){return this.setMap(b)};n.c.prototype=new o.OverlayView;n.c.prototype.draw=
function(){};return n}()}).call(this);}).call(this);
/* Fri 4 May 2012 11:50:38 BST */
