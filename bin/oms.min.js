(function(){/*
 OverlappingMarkerSpiderfier
 https://github.com/jawj/OverlappingMarkerSpiderfier
 Copyright (c) 2011 George MacKerron
 Released under the MIT licence: http://opensource.org/licenses/mit-license
*/
var j=null;
(function(){function l(l,i){return function(){return l.apply(i,arguments)}}var q=Array.prototype.slice;this.OverlappingMarkerSpiderfier=function(){function n(c,e){var b,d,g,a;this.map=c;this.G=e!=j?e:{};this.l=new this.constructor.c(this.map);this.h();this.a={};a=["click","zoom_changed","maptypeid_changed"];d=0;for(g=a.length;d<g;d++)b=a[d],i.event.addListener(this.map,b,l(function(){return this.unspiderfy()},this))}var i,o,k,f,a,p;a=n.prototype;a.VERSION="0.1.6";i=google.maps;f=i.MapTypeId;p=Math.PI*
2;a.nearbyDistance=20;a.circleSpiralSwitchover=9;a.circleFootSeparation=23;a.circleStartAngle=p/12;a.spiralFootSeparation=26;a.spiralLengthStart=11;a.spiralLengthFactor=4;a.spiderfiedZIndex=1E3;a.usualLegZIndex=10;a.highlightedLegZIndex=20;a.legWeight=1.5;a.legColors={usual:{},highlighted:{}};k=a.legColors.usual;o=a.legColors.highlighted;k[f.HYBRID]=k[f.SATELLITE]="#fff";o[f.HYBRID]=o[f.SATELLITE]="#f00";k[f.TERRAIN]=k[f.ROADMAP]="#444";o[f.TERRAIN]=o[f.ROADMAP]="#f00";a.h=function(){this.b=[];this.e=
[]};a.addMarker=function(c){var e,b,d;e=i.event.addListener(c,"click",l(function(){return this.C(c)},this));d=i.event.addListener(c,"visible_changed",l(function(){return this.j(c,!1)},this));b=i.event.addListener(c,"position_changed",l(function(){return this.j(c,!0)},this));this.e.push([e,d,b]);this.b.push(c);return this};a.j=function(c,e){if(c._omsData!=j&&(e||!c.getVisible())&&!(this.o!=j||this.q!=j))return this.H(e?c:j)};a.removeMarker=function(c){var e,b,d,g;c._omsData!=j&&this.unspiderfy();c=
this.f(this.b,c);if(!(c<0)){b=this.e.splice(c,1)[0];d=0;for(g=b.length;d<g;d++)e=b[d],i.event.removeListener(e);this.b.splice(c,1);return this}};a.clearMarkers=function(){var c,e,b,d,g,a,h;this.unspiderfy();h=this.e;b=0;for(g=h.length;b<g;b++){e=h[b];d=0;for(a=e.length;d<a;d++)c=e[d],i.event.removeListener(c)}this.h();return this};a.addListener=function(c,e){var b,d;((d=(b=this.a)[c])!=j?d:b[c]=[]).push(e);return this};a.removeListener=function(c,e){var b;b=this.f(this.a[c],e);b<0||this.a[c].splice(b,
1);return this};a.clearListeners=function(c){this.a[c]=[];return this};a.trigger=function(){var h;var c,e,b,d,g,a;e=arguments[0];c=2<=arguments.length?q.call(arguments,1):[];h=(b=this.a[e])!=j?b:[],e=h;a=[];d=0;for(g=e.length;d<g;d++)b=e[d],a.push(b.apply(j,c));return a};a.z=function(c,e){var b,d,g,a,h,i,l,f;a=[];h=e*e;g=this.i(c.position);f=this.b;i=0;for(l=f.length;i<l;i++)b=f[i],b.visible&&(d=this.i(b.position),this.m(d,g)<h&&a.push({v:b,k:d}));return a};a.r=function(c,e){var b,d,a,m,h;m=this.circleFootSeparation*
(2+c)/p;d=p/c;h=[];for(a=0;0<=c?a<c:a>c;0<=c?a+=1:a-=1)b=this.circleStartAngle+a*d,h.push(new i.Point(e.x+m*Math.cos(b),e.y+m*Math.sin(b)));return h};a.s=function(c,e){var b,d,a,m,h;a=this.spiralLengthStart;b=0;h=[];for(d=0;0<=c?d<c:d>c;0<=c?d+=1:d-=1)b+=this.spiralFootSeparation/a+d*5.0E-4,m=new i.Point(e.x+a*Math.cos(b),e.y+a*Math.sin(b)),a+=p*this.spiralLengthFactor/b,h.push(m);return h};a.C=function(c){var a;a=c._omsData!=j;this.unspiderfy();return a?this.trigger("click",c):(a=this.z(c,this.nearbyDistance),
a.length===1?this.trigger("click",c):this.D(a))};a.u=function(c){return{g:l(function(){return c._omsData.d.setOptions({strokeColor:this.legColors.highlighted[this.map.mapTypeId],zIndex:this.highlightedLegZIndex})},this),p:l(function(){return c._omsData.d.setOptions({strokeColor:this.legColors.usual[this.map.mapTypeId],zIndex:this.usualLegZIndex})},this)}};a.D=function(c){var a,b,d,g,m,h,f,n,o,k;this.o=!0;k=c.length;a=this.A(function(){var a,b,d;d=[];a=0;for(b=c.length;a<b;a++)n=c[a],d.push(n.k);return d}());
g=k>=this.circleSpiralSwitchover?this.s(k,a).reverse():this.r(k,a);a=function(){var a,e,k;k=[];a=0;for(e=g.length;a<e;a++){d=g[a];b=this.B(d);o=this.w(c,l(function(c){return this.m(c.k,d)},this));f=o.v;m=new i.Polyline({map:this.map,path:[f.position,b],strokeColor:this.legColors.usual[this.map.mapTypeId],strokeWeight:this.legWeight,zIndex:this.usualLegZIndex});f._omsData={F:f.position,d:m};if(this.legColors.highlighted[this.map.mapTypeId]!==this.legColors.usual[this.map.mapTypeId])h=this.u(f),i.event.addListener(f,
"mouseover",h.g),i.event.addListener(f,"mouseout",h.p),f._omsData.t=h;f.setPosition(b);f.setZIndex(Math.round(this.spiderfiedZIndex+d.y));k.push(f)}return k}.call(this);delete this.o;this.n=!0;return this.trigger("spiderfy",a)};a.unspiderfy=function(c){var a,b,d,g,f,h;c==j&&(c=j);if(this.n!=j){this.q=!0;d=[];h=this.b;g=0;for(f=h.length;g<f;g++)if(b=h[g],b._omsData!=j)b._omsData.d.setMap(j),b!==c&&b.setPosition(b._omsData.F),b.setZIndex(j),a=b._omsData.t,a!=j&&(i.event.clearListeners(b,"mouseover",
a.g),i.event.clearListeners(b,"mouseout",a.p)),delete b._omsData,d.push(b);delete this.q;delete this.n;this.trigger("unspiderfy",d);return this}};a.m=function(a,e){var b,d;b=a.x-e.x;d=a.y-e.y;return b*b+d*d};a.A=function(a){var e,b,d,g,f;g=b=d=0;for(f=a.length;g<f;g++)e=a[g],b+=e.x,d+=e.y;a=a.length;return new i.Point(b/a,d/a)};a.i=function(a){return this.l.getProjection().fromLatLngToDivPixel(a)};a.B=function(a){return this.l.getProjection().fromDivPixelToLatLng(a)};a.w=function(a,e){var b,d,g,f,
h;g=0;for(h=a.length;g<h;g++)if(f=a[g],f=e(f),!(typeof b!="undefined"&&b!==j)||f<d)d=f,b=g;return a.splice(b,1)[0]};a.f=function(a,e){var b,d,f;if(a.indexOf!=j)return a.indexOf(e);b=0;for(f=a.length;b<f;b++)if(d=a[b],d===e)return b;return-1};n.c=function(a){return this.setMap(a)};n.c.prototype=new i.OverlayView;n.c.prototype.draw=function(){};return n}()}).call(this);}).call(this);
/* Sat 6 Aug 2011 18:29:41 BST */
