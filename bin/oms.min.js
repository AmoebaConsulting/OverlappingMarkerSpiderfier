(function(){/*
 OverlappingMarkerSpiderfier
 https://github.com/jawj/OverlappingMarkerSpiderfier
 Copyright (c) 2011 George MacKerron
 Released under the MIT licence: http://opensource.org/licenses/mit-license
*/
var i=null;
(function(){function m(m,j){return function(){return m.apply(j,arguments)}}var s=Array.prototype.slice;this.OverlappingMarkerSpiderfier=function(){function o(c,d){var b,e,f,a;this.map=c;this.l=d!=i?d:{};this.m=new this.constructor.c(this.map);this.h();this.a={};a=["click","zoom_changed","maptypeid_changed"];e=0;for(f=a.length;e<f;e++)b=a[e],j.addListener(this.map,b,m(function(){return this.unspiderfy()},this))}var j,p,n,q,k,a,r;a=o.prototype;a.VERSION="0.1.7";p=google.maps;j=p.event;k=p.MapTypeId;
r=Math.PI*2;a.nearbyDistance=20;a.circleSpiralSwitchover=9;a.circleFootSeparation=23;a.circleStartAngle=r/12;a.spiralFootSeparation=26;a.spiralLengthStart=11;a.spiralLengthFactor=4;a.spiderfiedZIndex=1E3;a.usualLegZIndex=10;a.highlightedLegZIndex=20;a.legWeight=1.5;a.legColors={usual:{},highlighted:{}};q=a.legColors.usual;n=a.legColors.highlighted;q[k.HYBRID]=q[k.SATELLITE]="#fff";n[k.HYBRID]=n[k.SATELLITE]="#f00";q[k.TERRAIN]=q[k.ROADMAP]="#444";n[k.TERRAIN]=n[k.ROADMAP]="#f00";a.h=function(){this.b=
[];this.e=[]};a.addMarker=function(c){var d;d=[j.addListener(c,"click",m(function(){return this.D(c)},this))];this.l.markersWontHide||d.push(j.addListener(c,"visible_changed",m(function(){return this.j(c,!1)},this)));this.l.markersWontMove||d.push(j.addListener(c,"position_changed",m(function(){return this.j(c,!0)},this)));this.e.push(d);this.b.push(c);return this};a.j=function(c,d){if(c._omsData!=i&&(d||!c.getVisible())&&!(this.p!=i||this.r!=i))return this.H(d?c:i)};a.removeMarker=function(c){var d,
b,e,f;c._omsData!=i&&this.unspiderfy();c=this.f(this.b,c);if(!(c<0)){b=this.e.splice(c,1)[0];e=0;for(f=b.length;e<f;e++)d=b[e],j.removeListener(d);this.b.splice(c,1);return this}};a.clearMarkers=function(){var c,d,b,e,f,a,g;this.unspiderfy();g=this.e;b=0;for(f=g.length;b<f;b++){d=g[b];e=0;for(a=d.length;e<a;e++)c=d[e],j.removeListener(c)}this.h();return this};a.addListener=function(c,d){var b,e;((e=(b=this.a)[c])!=i?e:b[c]=[]).push(d);return this};a.removeListener=function(c,d){var b;b=this.f(this.a[c],
d);b<0||this.a[c].splice(b,1);return this};a.clearListeners=function(c){this.a[c]=[];return this};a.trigger=function(){var g;var c,d,b,e,f,a;d=arguments[0];c=2<=arguments.length?s.call(arguments,1):[];g=(b=this.a[d])!=i?b:[],d=g;a=[];e=0;for(f=d.length;e<f;e++)b=d[e],a.push(b.apply(i,c));return a};a.A=function(c,d){var b,e,f,a,g,l,j,m;a=[];g=d*d;f=this.i(c.position);m=this.b;l=0;for(j=m.length;l<j;l++)b=m[l],b.visible&&(e=this.i(b.position),this.n(e,f)<g&&a.push({w:b,k:e}));return a};a.s=function(c,
d){var b,e,a,h,g;h=this.circleFootSeparation*(2+c)/r;e=r/c;g=[];for(a=0;0<=c?a<c:a>c;0<=c?a+=1:a-=1)b=this.circleStartAngle+a*e,g.push(new p.Point(d.x+h*Math.cos(b),d.y+h*Math.sin(b)));return g};a.t=function(c,d){var b,a,f,h,g;f=this.spiralLengthStart;b=0;g=[];for(a=0;0<=c?a<c:a>c;0<=c?a+=1:a-=1)b+=this.spiralFootSeparation/f+a*5.0E-4,h=new p.Point(d.x+f*Math.cos(b),d.y+f*Math.sin(b)),f+=r*this.spiralLengthFactor/b,g.push(h);return g};a.D=function(c){var a;a=c._omsData!=i;this.unspiderfy();return a?
this.trigger("click",c):(a=this.A(c,this.nearbyDistance),a.length===1?this.trigger("click",c):this.F(a))};a.v=function(c){return{g:m(function(){return c._omsData.d.setOptions({strokeColor:this.legColors.highlighted[this.map.mapTypeId],zIndex:this.highlightedLegZIndex})},this),q:m(function(){return c._omsData.d.setOptions({strokeColor:this.legColors.usual[this.map.mapTypeId],zIndex:this.usualLegZIndex})},this)}};a.F=function(c){var a,b,e,f,h,g,l,k,o,n;this.p=!0;n=c.length;a=this.B(function(){var a,
b,d;d=[];a=0;for(b=c.length;a<b;a++)k=c[a],d.push(k.k);return d}());f=n>=this.circleSpiralSwitchover?this.t(n,a).reverse():this.s(n,a);a=function(){var a,d,k;k=[];a=0;for(d=f.length;a<d;a++){e=f[a];b=this.C(e);o=this.z(c,m(function(c){return this.n(c.k,e)},this));l=o.w;h=new p.Polyline({map:this.map,path:[l.position,b],strokeColor:this.legColors.usual[this.map.mapTypeId],strokeWeight:this.legWeight,zIndex:this.usualLegZIndex});l._omsData={G:l.position,d:h};if(this.legColors.highlighted[this.map.mapTypeId]!==
this.legColors.usual[this.map.mapTypeId])g=this.v(l),j.addListener(l,"mouseover",g.g),j.addListener(l,"mouseout",g.q),l._omsData.u=g;l.setPosition(b);l.setZIndex(Math.round(this.spiderfiedZIndex+e.y));k.push(l)}return k}.call(this);delete this.p;this.o=!0;return this.trigger("spiderfy",a)};a.unspiderfy=function(c){var a,b,e,f,h,g;c==i&&(c=i);if(this.o!=i){this.r=!0;e=[];g=this.b;f=0;for(h=g.length;f<h;f++)if(b=g[f],b._omsData!=i)b._omsData.d.setMap(i),b!==c&&b.setPosition(b._omsData.G),b.setZIndex(i),
a=b._omsData.u,a!=i&&(j.clearListeners(b,"mouseover",a.g),j.clearListeners(b,"mouseout",a.q)),delete b._omsData,e.push(b);delete this.r;delete this.o;this.trigger("unspiderfy",e);return this}};a.n=function(a,d){var b,e;b=a.x-d.x;e=a.y-d.y;return b*b+e*e};a.B=function(a){var d,b,e,f,h;f=b=e=0;for(h=a.length;f<h;f++)d=a[f],b+=d.x,e+=d.y;a=a.length;return new p.Point(b/a,e/a)};a.i=function(a){return this.m.getProjection().fromLatLngToDivPixel(a)};a.C=function(a){return this.m.getProjection().fromDivPixelToLatLng(a)};
a.z=function(a,d){var b,e,f,h,g;f=0;for(g=a.length;f<g;f++)if(h=a[f],h=d(h),!(typeof b!="undefined"&&b!==i)||h<e)e=h,b=f;return a.splice(b,1)[0]};a.f=function(a,d){var b,e,f;if(a.indexOf!=i)return a.indexOf(d);b=0;for(f=a.length;b<f;b++)if(e=a[b],e===d)return b;return-1};o.c=function(a){return this.setMap(a)};o.c.prototype=new p.OverlayView;o.c.prototype.draw=function(){};return o}()}).call(this);}).call(this);
/* Sun 7 Aug 2011 14:52:52 BST */
