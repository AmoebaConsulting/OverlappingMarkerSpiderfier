(function(){/*
 OverlappingMarkerSpiderfier
 https://github.com/jawj/OverlappingMarkerSpiderfier
 Copyright (c) 2011 George MacKerron
 Released under the MIT licence: http://opensource.org/licenses/mit-license
*/
var k=null;
(function(){function o(i,g){return function(){return i.apply(g,arguments)}}var q=Array.prototype.slice;this.OverlappingMarkerSpiderfier=function(){function i(a){var c,f,d;this.map=a;this.j=new this.constructor.c(this.map);this.h=[];this.b=[];this.f={};d=["click","zoom_changed","maptypeid_changed"];c=0;for(f=d.length;c<f;c++)a=d[c],g.event.addListener(this.map,a,o(function(){return this.unspiderfy()},this))}var g,n,j,e,b,p;b=i.prototype;b.VERSION="0.1.3";g=google.maps;e=g.MapTypeId;p=Math.PI*2;b.nearbyDistance=
20;b.circleSpiralSwitchover=9;b.circleFootSeparation=23;b.circleStartAngle=p/12;b.spiralFootSeparation=26;b.spiralLengthStart=11;b.spiralLengthFactor=4;b.spiderfiedZIndex=1E3;b.usualLegZIndex=10;b.highlightedLegZIndex=20;b.legWeight=1.5;b.legColors={usual:{},highlighted:{}};j=b.legColors.usual;n=b.legColors.highlighted;j[e.HYBRID]=j[e.SATELLITE]="#fff";n[e.HYBRID]=n[e.SATELLITE]="#f00";j[e.TERRAIN]=j[e.ROADMAP]="#444";n[e.TERRAIN]=n[e.ROADMAP]="#f00";b.addMarker=function(a){this.h.push(g.event.addListener(a,
"click",o(function(){return this.z(a)},this)));this.b.push(a);return this};b.removeMarker=function(a){var c;a.a!=k&&this.unspiderfy();a=this.n(this.b,a);if(!(a<0))return c=this.h.splice(a,1)[0],g.event.removeListener(c),this.b.splice(a,1),this};b.addListener=function(a,c){var f,d;((d=(f=this.f)[a])!=k?d:f[a]=[]).push(c);return this};b.trigger=function(){var h;var a,c,f,d,l,b;c=arguments[0];a=2<=arguments.length?q.call(arguments,1):[];h=(f=this.f[c])!=k?f:[],c=h;b=[];d=0;for(l=c.length;d<l;d++)f=c[d],
b.push(f.apply(k,a));return b};b.u=function(a,c){var f,d,l,b,h,g,e,i;b=[];h=c*c;l=this.g(a.position);i=this.b;g=0;for(e=i.length;g<e;g++)f=i[g],d=this.g(f.position),this.k(d,l)<h&&b.push({s:f,i:d});return b};b.o=function(a,c){var f,d,b,m,h;m=this.circleFootSeparation*(2+a)/p;d=p/a;h=[];for(b=0;0<=a?b<a:b>a;0<=a?b+=1:b-=1)f=this.circleStartAngle+b*d,h.push(new g.Point(c.x+m*Math.cos(f),c.y+m*Math.sin(f)));return h};b.p=function(a,c){var f,d,b,m,h;b=this.spiralLengthStart;f=0;h=[];for(d=0;0<=a?d<a:
d>a;0<=a?d+=1:d-=1)f+=this.spiralFootSeparation/b+d*5.0E-4,m=new g.Point(c.x+b*Math.cos(f),c.y+b*Math.sin(f)),b+=p*this.spiralLengthFactor/f,h.push(m);return h};b.z=function(a){var c;c=a.a!=k;this.unspiderfy();return c?this.trigger("click",a):(c=this.u(a,this.nearbyDistance),c.length===1?this.trigger("click",a):this.A(c))};b.r=function(a){return{e:o(function(){return a.a.d.setOptions({strokeColor:this.legColors.highlighted[this.map.mapTypeId],zIndex:this.highlightedLegZIndex})},this),m:o(function(){return a.a.d.setOptions({strokeColor:this.legColors.usual[this.map.mapTypeId],
zIndex:this.usualLegZIndex})},this)}};b.A=function(a){var c,b,d,l,m,h,e,i,n,j;this.l=!0;j=a.length;c=this.v(function(){var c,b,d;d=[];c=0;for(b=a.length;c<b;c++)i=a[c],d.push(i.i);return d}());l=j>=this.circleSpiralSwitchover?this.p(j,c).reverse():this.o(j,c);return this.trigger("spiderfy",function(){var c,i,j;j=[];c=0;for(i=l.length;c<i;c++){d=l[c];b=this.w(d);n=this.t(a,o(function(a){return this.k(a.i,d)},this));e=n.s;m=new g.Polyline({map:this.map,path:[e.position,b],strokeColor:this.legColors.usual[this.map.mapTypeId],
strokeWeight:this.legWeight,zIndex:this.usualLegZIndex});e.a={B:e.position,d:m};if(this.legColors.highlighted[this.map.mapTypeId]!==this.legColors.usual[this.map.mapTypeId])h=this.r(e),g.event.addListener(e,"mouseover",h.e),g.event.addListener(e,"mouseout",h.m),e.a.q=h;e.setPosition(b);e.setZIndex(Math.round(this.spiderfiedZIndex+d.y));j.push(e)}return j}.call(this))};b.unspiderfy=function(){var a,c,b,d,l,e;if(this.l!=k){delete this.l;b=[];e=this.b;d=0;for(l=e.length;d<l;d++)if(c=e[d],c.a!=k)c.a.d.setMap(k),
c.setPosition(c.a.B),c.setZIndex(k),a=c.a.q,a!=k&&(g.event.clearListeners(c,"mouseover",a.e),g.event.clearListeners(c,"mouseout",a.m)),delete c.a,b.push(c);return this.trigger("unspiderfy",b)}};b.k=function(a,c){var b,d;b=a.x-c.x;d=a.y-c.y;return b*b+d*d};b.v=function(a){var b,f,d,e,m;e=f=d=0;for(m=a.length;e<m;e++)b=a[e],f+=b.x,d+=b.y;a=a.length;return new g.Point(f/a,d/a)};b.g=function(a){return this.j.getProjection().fromLatLngToDivPixel(a)};b.w=function(a){return this.j.getProjection().fromDivPixelToLatLng(a)};
b.t=function(a,b){var f,d,e,g,h;e=0;for(h=a.length;e<h;e++)if(g=a[e],g=b(g),!(typeof f!="undefined"&&f!==k)||g<d)d=g,f=e;return a.splice(f,1)[0]};b.n=function(a,b){var e,d,g;if(a.indexOf!=k)return a.indexOf(b);e=0;for(g=a.length;e<g;e++)if(d=a[e],d===b)return e;return-1};i.c=function(a){return this.setMap(a)};i.c.prototype=new g.OverlayView;i.c.prototype.draw=function(){};return i}()}).call(this);}).call(this);
/* Fri 5 Aug 2011 17:43:16 BST */
